/*
 MeeusSunMoon v1.0.0
 (c) 2016 Jan Greis
 licensed under MIT
*/
var MeeusSunMoon=function(){var q={roundToNearestMinute:!1,returnTimeForPNMS:!1},t={datetimeToJD:function(a){var c=a.year(),e=a.month()+1,b=a.date()+(a.hour()+(a.minute()+a.second()/60)/60)/24;3>e&&(--c,e+=12);var g=Math.floor(c/100),d=moment("1582-10-15T12:00:00Z"),k=0;a.isAfter(d)&&(k=2-g+Math.floor(g/4));return Math.floor(365.25*(c+4716))+Math.floor(30.6001*(e+1))+b+k-1524.5},JDToDatetime:function(a){a+=.5;var c=Math.floor(a),e=c;if(2299161<=c)var b=Math.floor((c-1867216.25)/36524.25),e=e+(1+b-
Math.floor(b/4));var g=e+1524,e=Math.floor((g-122.1)/365.25),d=Math.floor(365.25*e),b=Math.floor((g-d)/30.6001),d=g-d-Math.floor(30.6001*b)+(a-c);a=Math.floor(d);var c=Math.floor(24*(d-a)),g=Math.floor(60*(24*(d-a)-c)),d=Math.floor(60*(60*(24*(d-a)-c)-g)),k=b-1;13<b&&(k-=12);e-=4715;2<k&&--e;b=moment.tz("2000-01-01T12:00:00","UTC");b.year(e);b.month(k-1);b.date(a);b.hour(c);b.minute(g);b.second(d);return b},JDToT:function(a){return(a-2451545)/36525},datetimeToT:function(a){return t.JDToT(t.datetimeToJD(a))},
DeltaT:function(a){var c=a.year(),c=c+(a.month()+.5)/12;switch(!0){case -1999>c:a=!1;break;case -500>c:a=(c-1820)/100;a=-20+32*a*a;break;case 500>c:a=c/100;a=10583.6-1014.41*a+33.78311*a*a-5.952053*a*a*a-.1798452*a*a*a*a+.022174192*a*a*a*a*a+.0090316521*a*a*a*a*a*a;break;case 1600>c:a=(c-1E3)/100;a=1574.2-556.01*a+71.23472*a*a+.319781*a*a*a-.8503463*a*a*a*a-.005050998*a*a*a*a*a+.0083572073*a*a*a*a*a*a;break;case 1700>c:a=c-1600;a=120-.9808*a-.01532*a*a+a*a*a/7129;break;case 1800>c:a=c-1700;a=8.83+
.1603*a-.0059285*a*a+1.3336E-4*a*a*a-a*a*a*a/1174E3;break;case 1860>c:a=c-1800;a=13.72-.332447*a+.0068612*a*a+.0041116*a*a*a-3.7436E-4*a*a*a*a+1.21272E-5*a*a*a*a*a-1.699E-7*a*a*a*a*a*a+8.75E-10*a*a*a*a*a*a*a;break;case 1900>c:a=c-1860;a=7.62+.5737*a-.251754*a*a+.01680668*a*a*a-4.473624E-4*a*a*a*a+a*a*a*a*a/233174;break;case 1920>c:a=c-1900;a=-2.79+1.494119*a-.0598939*a*a+.0061966*a*a*a-1.97E-4*a*a*a*a;break;case 1941>c:a=c-1920;a=21.2+.84493*a-.0761*a*a+.0020936*a*a*a;break;case 1961>c:a=c-1950;a=
29.07+.407*a-a*a/233+a*a*a/2547;break;case 1986>c:a=c-1975;a=45.45+1.067*a-a*a/260-a*a*a/718;break;case 2005>c:a=c-2E3;a=63.86+.3345*a-.060374*a*a+.0017275*a*a*a+6.51814E-4*a*a*a*a+2.373599E-5*a*a*a*a*a;break;case 2050>c:a=c-2E3;a=62.92+.32217*a+.005589*a*a;break;case 2150>c:a=-20+(c-1820)/100*32*((c-1820)/100)-.5628*(2150-c);break;default:a=(c-1820)/100,a=-20+32*a*a}return a},approxK:function(a){return 12.3685*(a.year()+(a.month()+1)/12+a.date()/365.25-2E3)},kToT:function(a){return a/1236.85}},b=
{deg2rad:function(a){return.017453292519943295*a},rad2deg:function(a){return 57.29577951308232*a},sind:function(a){return Math.sin(b.deg2rad(a))},cosd:function(a){return Math.cos(b.deg2rad(a))},reduceAngle:function(a){return a-360*Math.floor(a/360)},modulo:function(a,c){return a-c*Math.floor(a/c)},polynomial:function(a,c){for(var b=1,f=0,d=c.length,h=0;h<d;h++)f+=b*c[h],b*=a;return f},interpolateFromThree:function(a,c,b,f,d){"undefined"===typeof d&&(d=!1);a=c-a;b-=c;d&&(0>a&&(a+=360),0>b&&(b+=360));
return c+f/2*(a+b+f*(b-a))}},r={truePhase:function(a,c){a+=c/4;var b=t.kToT(a),f=r.eccentricityCorrection(b),d=r.meanPhase(b,a),h=r.sunMeanAnomaly(b,a),k=r.moonMeanAnomaly(b,a),m=r.moonArgumentOfLatitude(b,a),l=r.moonAscendingNodeLongitude(b,a),b=r.planetaryArguments(b,a),p=0;if(0===c||2===c)p+=r.newMoonFullMoonCorrections(f,h,k,m,l,c);else if(1===c||3===c)p+=r.quarterCorrections(f,h,k,m,l,c);p+=r.commonCorrections(b);return d+p},meanPhase:function(a,c){return 2451550.09766+29.530588861*c+1.5437E-4*
a*a-1.5E-7*a*a*a+7.3E-10*a*a*a*a},sunMeanAnomaly:function(a,c){return 2.5534+29.1053567*c-1.4E-6*a*a-1.1E-7*a*a*a},moonMeanAnomaly:function(a,c){return 201.5643+385.81693528*c+.0107582*a*a+1.238E-5*a*a*a-5.8E-8*a*a*a*a},moonArgumentOfLatitude:function(a,c){return 160.7108+390.67050284*c-.0016118*a*a-2.27E-6*a*a*a+1.1E-8*a*a*a*a},moonAscendingNodeLongitude:function(a,c){return 124.7746-1.56375588*c+.0020672*a*a+2.15E-6*a*a*a},eccentricityCorrection:function(a){return 1-.002516*a-7.4E-6*a*a},planetaryArguments:function(a,
c){var b=[0];b[1]=299.77+.107408*c-.009173*a*a;b[2]=251.88+.016321*c;b[3]=251.83+26.651886*c;b[4]=349.42+36.412478*c;b[5]=84.66+18.206239*c;b[6]=141.74+53.303771*c;b[7]=207.14+2.453732*c;b[8]=154.84+7.30686*c;b[9]=34.52+27.261239*c;b[10]=207.19+.121824*c;b[11]=291.34+1.844379*c;b[12]=161.72+24.198154*c;b[13]=239.56+25.513099*c;b[14]=331.55+3.592518*c;return b},commonCorrections:function(a){return 3.25E-4*b.sind(a[1])+1.65E-4*b.sind(a[2])+1.64E-4*b.sind(a[3])+1.26E-4*b.sind(a[4])+1.1E-4*b.sind(a[5])+
6.2E-5*b.sind(a[6])+6E-5*b.sind(a[7])+5.6E-5*b.sind(a[8])+4.7E-5*b.sind(a[9])+4.2E-5*b.sind(a[10])+4E-5*b.sind(a[11])+3.7E-5*b.sind(a[12])+3.5E-5*b.sind(a[13])+2.3E-5*b.sind(a[14])},newMoonFullMoonCorrections:function(a,c,e,f,d,h){d=-.00111*b.sind(e-2*f)-5.7E-4*b.sind(e+2*f)+5.6E-4*a*b.sind(2*e+c)-4.2E-4*b.sind(3*e)+4.2E-4*a*b.sind(c+2*f)+3.8E-4*a*b.sind(c-2*f)-2.4E-4*a*b.sind(2*e-c)-1.7E-4*b.sind(d)-7E-5*b.sind(e+2*c)+4E-5*b.sind(2*e-2*f)+4E-5*b.sind(3*c)+3E-5*b.sind(e+c-2*f)+3E-5*b.sind(2*e+2*f)-
3E-5*b.sind(e+c+2*f)+3E-5*b.sind(e-c+2*f)-2E-5*b.sind(e-c-2*f)-2E-5*b.sind(3*e+c)+2E-5*b.sind(4*e);0===h?d+=-.4072*b.sind(e)+.17241*a*b.sind(c)+.01608*b.sind(2*e)+.01039*b.sind(2*f)+.00739*a*b.sind(e-c)-.00514*a*b.sind(e+c)+.00208*a*a*b.sind(2*c):2===h&&(d+=-.40614*b.sind(e)+.17302*a*b.sind(c)+.01614*b.sind(2*e)+.01043*b.sind(2*f)+.00734*a*b.sind(e-c)-.00515*a*b.sind(e+c)+.00209*a*a*b.sind(2*c));return d},quarterCorrections:function(a,c,e,d,g,h){g=-.62801*b.sind(e)+.17172*a*b.sind(c)-.01183*a*b.sind(e+
c)+.00862*b.sind(2*e)+.00804*b.sind(2*d)+.00454*a*b.sind(e-c)+.00204*a*a*b.sind(2*c)-.0018*b.sind(e-2*d)-7E-4*b.sind(e+2*d)-4E-4*b.sind(3*e)-3.4E-4*a*b.sind(2*e-c)+3.2E-4*a*b.sind(c+2*d)+3.2E-4*a*b.sind(c-2*d)-2.8E-4*a*a*b.sind(e+2*c)+2.7E-4*a*b.sind(2*e+c)-1.7E-4*b.sind(g)-5E-5*b.sind(e-c-2*d)+4E-5*b.sind(2*e+2*d)-4E-5*b.sind(e+c+2*d)+4E-5*b.sind(e-2*c)+3E-5*b.sind(e+c-2*d)+3E-5*b.sind(3*c)+2E-5*b.sind(2*e-2*d)+2E-5*b.sind(e-c+2*d)-2E-5*b.sind(3*e+c);a=.00306-3.8E-4*a*b.cosd(c)+2.6E-4*b.cosd(e)-
2E-5*b.cosd(e-c)+2E-5*b.cosd(e+c)+2E-5*b.cosd(2*d);1===h?g+=a:3===h&&(g-=a);return g}},v=[357.52772,35999.05034,-1.603E-4,-1/3E5],w=[280.46646,36000.76983,3.032E-4],x=[84381.448/3600,-4680.93/3600,-1.55/3600,1999.25/3600,-51.38/3600,-249.67/3600,-39.05/3600,7.12/3600,27.87/3600,5.79/3600,2.45/3600],y=[93.27191,483202.017538,-.0036825,1/327270],z=[125.04452,-1934.136261,.0020708,1/45E4],A=[134.96298,477198.867398,.0086972,1/56250],B=[297.85036,445267.11148,-.0019142,1/189474],n=[[0,0,0,0,1,-171996,
-174.2,92025,8.9],[-2,0,0,2,2,-13187,-1.6,5736,-3.1],[0,0,0,2,2,-2274,-.2,977,-.5],[0,0,0,0,2,2062,.2,-895,.5],[0,1,0,0,0,1426,-3.4,54,-.1],[0,0,1,0,0,712,.1,-7,0],[-2,1,0,2,2,-517,1.2,224,-.6],[0,0,0,2,1,-386,-.4,200,0],[0,0,1,2,2,-301,0,129,-.1],[-2,-1,0,2,2,217,-.5,-95,.3],[-2,0,1,0,0,-158,0,0,0],[-2,0,0,2,1,129,.1,-70,0],[0,0,-1,2,2,123,0,-53,0],[2,0,0,0,0,63,0,0,0],[0,0,1,0,1,63,.1,-33,0],[2,0,-1,2,2,-59,0,26,0],[0,0,-1,0,1,-58,-.1,32,0],[0,0,1,2,1,-51,0,27,0],[-2,0,2,0,0,48,0,0,0],[0,0,-2,2,
1,46,0,-24,0],[2,0,0,2,2,-38,0,16,0],[0,0,2,2,2,-31,0,13,0],[0,0,2,0,0,29,0,0,0],[-2,0,1,2,2,29,0,-12,0],[0,0,0,2,0,26,0,0,0],[-2,0,0,2,0,-22,0,0,0],[0,0,-1,2,1,21,0,-10,0],[0,2,0,0,0,17,-.1,0,0],[2,0,-1,0,1,16,0,-8,0],[-2,2,0,2,2,-16,.1,7,0],[0,1,0,0,1,-15,0,9,0],[-2,0,1,0,1,-13,0,7,0],[0,-1,0,0,1,-12,0,6,0],[0,0,2,-2,0,11,0,0,0],[2,0,-1,2,1,-10,0,5,0],[2,0,1,2,2,-8,0,3,0],[0,1,0,2,2,7,0,-3,0],[-2,1,1,0,0,-7,0,0,0],[0,-1,0,2,2,-7,0,3,0],[2,0,0,2,1,-7,0,3,0],[2,0,1,0,0,6,0,0,0],[-2,0,2,2,2,6,0,-3,
0],[-2,0,1,2,1,6,0,-3,0],[2,0,-2,0,1,-6,0,3,0],[2,0,0,0,1,-6,0,3,0],[0,-1,1,0,0,5,0,0,0],[-2,-1,0,2,1,-5,0,3,0],[-2,0,0,0,1,-5,0,3,0],[0,0,2,2,1,-5,0,3,0],[-2,0,2,0,1,4,0,0,0],[-2,1,0,2,1,4,0,0,0],[0,0,1,-2,0,4,0,0,0],[-1,0,1,0,0,-4,0,0,0],[-2,1,0,0,0,-4,0,0,0],[1,0,0,0,0,-4,0,0,0],[0,0,1,2,0,3,0,0,0],[0,0,-2,2,2,-3,0,0,0],[-1,-1,1,0,0,-3,0,0,0],[0,1,1,0,0,-3,0,0,0],[0,-1,1,2,2,-3,0,0,0],[2,-1,-1,2,2,-3,0,0,0],[0,0,3,2,2,3,0,0,0],[2,-1,0,2,2,-3,0,0,0]],d={sunTransit:function(a,c){var b=a.tz(),f=moment.tz([a.year(),
a.month(),a.date(),0,0,0],"UTC"),g=t.DeltaT(f),h=t.datetimeToT(f),k=d.apparentSiderealTimeGreenwhich(h),m=(d.sunApparentRightAscension(h-g/315576E4)-c-k)/360,m=d.normalizeM(m,a.utcOffset()),g=d.sunTransitCorrection(h,k,g,c,m);f.add(Math.floor(86400*(m+g)+.5),"seconds");q.roundToNearestMinute&&(f.add(30,"seconds"),f.second(0));f.tz(b);return f},sunRiseSet:function(a,c,b,f){var g=a.tz(),h=moment.tz([a.year(),a.month(),a.date(),0,0,0],"UTC"),k=t.DeltaT(h),m=t.datetimeToT(h),l=d.apparentSiderealTimeGreenwhich(m),
p=m-k/315576E4,n=d.sunApparentRightAscension(p),p=d.sunApparentDeclination(p),p=d.approxLocalHourAngle(c,p);a=d.normalizeM((n-b-l)/360,a.utcOffset());if("RISE"===f)f=a-p/360;else if("SET"===f)f=a+p/360;else return!1;a=0;for(n=1;1E-4<Math.abs(n)&&3>a;)n=d.sunRiseSetCorrection(m,l,k,c,b,f),f+=n,a++;0<f?h.add(Math.floor(86400*f+.5),"seconds"):h.subtract(Math.floor(86400*Math.abs(f)+.5),"seconds");q.roundToNearestMinute&&(h.add(30,"seconds"),h.second(0));h.tz(g);return h},approxLocalHourAngle:function(a,
c){var e=(b.sind(-50/60)-b.sind(a)*b.sind(c))/(b.cosd(a)*b.cosd(c));if(-1>e){if(q.returnTimeForPNMS)throw moment.tz("**2000-01-01 12:00:00","YYYY-MM-DD HH:mm:ss","Europe/London");throw"MS";}if(1<e){if(q.returnTimeForPNMS)throw moment.tz("--2000-01-01 12:00:00","YYYY-MM-DD HH:mm:ss","Europe/London");throw"PN";}return b.rad2deg(Math.acos(e))},normalizeM:function(a,c){var b=a+c/1440;return 0>b?a+1:1<b?a-1:a},sunTransitCorrection:function(a,c,b,f,g){c+=360.985647*g;a=d.interpolatedRa(a,g+b/864E3);return-d.localHourAngle(c,
f,a)/360},sunRiseSetCorrection:function(a,c,e,f,g,h){c+=360.985647*h;h+=e/864E3;e=d.interpolatedRa(a,h);a=d.interpolatedDec(a,h);g=d.localHourAngle(c,g,e);return(d.altitude(f,a,g)+50/60)/(360*b.cosd(a)*b.cosd(f)*b.sind(g))},localHourAngle:function(a,c,e){a=b.reduceAngle(a+c-e);180<a&&(a-=360);return a},altitude:function(a,c,e){return b.rad2deg(Math.asin(b.sind(a)*b.sind(c)+b.cosd(a)*b.cosd(c)*b.cosd(e)))},interpolatedRa:function(a,c){var e=d.sunApparentRightAscension(a-1/36525),f=d.sunApparentRightAscension(a),
g=d.sunApparentRightAscension(a+1/36525),e=b.interpolateFromThree(e,f,g,c,!0);return b.reduceAngle(e)},interpolatedDec:function(a,c){var e=d.sunApparentDeclination(a-1/36525),f=d.sunApparentDeclination(a),g=d.sunApparentDeclination(a+1/36525),e=b.interpolateFromThree(e,f,g,c);return b.reduceAngle(e)},sunApparentRightAscension:function(a){var c=d.moonAscendingNodeLongitude(a),c=d.trueObliquityOfEcliptic(a)+.00256*b.cosd(c);a=d.sunApparentLongitude(a);a=b.rad2deg(Math.atan2(b.cosd(c)*b.sind(a),b.cosd(a)));
return b.reduceAngle(a)},sunApparentDeclination:function(a){var c=d.moonAscendingNodeLongitude(a),c=d.trueObliquityOfEcliptic(a)+.00256*b.cosd(c);a=d.sunApparentLongitude(a);return b.rad2deg(Math.asin(b.sind(c)*b.sind(a)))},apparentSiderealTimeGreenwhich:function(a){var c=d.meanSiderealTimeGreenwhich(a),e=d.trueObliquityOfEcliptic(a);a=d.nutationInLongitude(a);c+=a*b.cosd(e);return b.reduceAngle(c)},meanSiderealTimeGreenwhich:function(a){return 280.46061837+1.3185000770053742E7*a+3.87933E-4*a*a-a*
a*a/3871E4},trueObliquityOfEcliptic:function(a){var c=d.meanObliquityOfEcliptic(a);a=d.nutationInObliquity(a);return c+a},meanObliquityOfEcliptic:function(a){return b.polynomial(a/100,x)},sunApparentLongitude:function(a){var c=d.sunTrueLongitude(a);a=d.moonAscendingNodeLongitude(a);return c-.00569-.00478*b.sind(a)},sunTrueLongitude:function(a){var c=d.sunMeanLongitude(a);a=d.sunEquationOfCenter(a);return c+a},sunEquationOfCenter:function(a){var c=d.sunMeanAnomaly(a);return(1.914602-.004817*a-1.4E-5*
a*a)*b.sind(c)+(.019993-1.01E-4*a)*b.sind(2*c)+2.9E-4*b.sind(3*c)},nutationInLongitude:function(a){for(var c=d.moonMeanElongation(a),e=d.sunMeanAnomaly(a),f=d.moonMeanAnomaly(a),g=d.moonArgumentOfLatitude(a),h=d.moonAscendingNodeLongitude(a),k=0,m,l=0;63>l;l++)m=n[l][0]*c+n[l][1]*e+n[l][2]*f+n[l][3]*g+n[l][4]*h,k+=(n[l][5]+n[l][6]*a)*b.sind(m);return k/36E6},nutationInObliquity:function(a){for(var c=d.moonMeanElongation(a),e=d.sunMeanAnomaly(a),f=d.moonMeanAnomaly(a),g=d.moonArgumentOfLatitude(a),
h=d.moonAscendingNodeLongitude(a),k=0,m,l=0;63>l;l++)m=n[l][0]*c+n[l][1]*e+n[l][2]*f+n[l][3]*g+n[l][4]*h,k+=(n[l][7]+n[l][8]*a)*b.cosd(m);return k/36E6},moonArgumentOfLatitude:function(a){a=b.polynomial(a,y);return b.reduceAngle(a)},moonAscendingNodeLongitude:function(a){a=b.polynomial(a,z);return b.reduceAngle(a)},moonMeanAnomaly:function(a){a=b.polynomial(a,A);return b.reduceAngle(a)},moonMeanElongation:function(a){a=b.polynomial(a,B);return b.reduceAngle(a)},sunMeanAnomaly:function(a){a=b.polynomial(a,
v);return b.reduceAngle(a)},sunMeanLongitude:function(a){a=b.polynomial(a,w);return b.reduceAngle(a)}},u=function(a,c,b){q.returnTimeForPNMS&&(c.isDST()&&(b+=1),a.tz(c.tz()).year(c.year()).month(c.month()).date(c.date()).hour(b).minute(0).second(0));return a};q.sunrise=function(a,b,e){var f;try{f=d.sunRiseSet(a,b,e,"RISE")}catch(g){return u(g,a,6)}return f};q.sunset=function(a,b,e){var f;try{f=d.sunRiseSet(a,b,e,"SET")}catch(g){return u(g,a,18)}return f};q.solarNoon=function(a,b){return d.sunTransit(a,
b)};q.yearMoonPhases=function(a,b,e){var d=moment([a]);a=moment([a+1]);for(var g=Math.floor(t.approxK(d))-1,h=[],k,m,l=0;15>l;l++)k=r.truePhase(g,b),k=t.JDToDatetime(k),m=t.DeltaT(k),0<m?k.subtract(Math.abs(m),"seconds"):k.add(Math.abs(m),"seconds"),q.roundToNearestMinute&&(k.add(30,"seconds"),k.second(0)),void 0!==e&&(e="UTC"),k.tz(e),k.isAfter(d)&&k.isBefore(a)&&h.push(k),g++;return h};return q}();
